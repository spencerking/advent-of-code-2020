My current solution is pretty naive (O(n^3) gross!).

It could be done more efficiently by sorting first.
